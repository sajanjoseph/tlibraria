*{ You can use plain selenium command using the selenium tag }*

#{fixture delete:'all', load:'data.yml' /}

#{selenium}
	clearSession()
    // Open the home page, and check that no error occured
    open('/')
    waitForPageToLoad(1000)
    assertNotTitle('Application error')
    assertTitle('Home')
    assertTextPresent('Taberna Libraria')
#{/selenium}

#{selenium 'search with a keyword'}
	clearSession()
    // Open the home page, and check that no error occured
    open('/')
    waitForPageToLoad(1000)
    assertTitle('Home')
    type('keyword','magic')
    clickAndWait('kwsearch')
    assertTitle('search results')
    assertTextPresent('Wizard and Glass (The Dark Tower, Book 4)')
    assertTextPresent('The Winter King (The Arthur Books 1)')
    assertTextPresent('Harry Potter and the Chamber of Secrets')
    assertTextPresent('Harry Potter and the Prisoner of Azkaban')
#{/selenium}

#{selenium 'search with a keyword not in book'}
	clearSession()
    // Open the home page, and check that no error occured
    open('/')
    waitForPageToLoad(1000)
    assertTitle('Home')
    type('keyword','23444')
    clickAndWait('kwsearch')
    assertTitle('search results')
    assertTextPresent('could not find books with name containing '23444' here')
#{/selenium}

#{selenium 'add review to book'}
	clearSession()
	open('/')
	waitForPageToLoad(1000)
    assertTitle('Home')
    type('author','den')
    type('content','my first review')
    clickAndWait('reviewsubmit')
    assertTextPresent('Thanks for your review')
    assertTextPresent('my first review')
#{/selenium}

#{selenium 'missing author field in addreview'}
	clearSession()
	open('/')
	waitForPageToLoad(1000)
    assertTitle('Home')
    type('content','my second review')
    clickAndWait('reviewsubmit')
    assertTextPresent('Error adding Review!')
#{/selenium}

#{selenium 'missing content field in addreview'}
	clearSession()
	open('/')
	waitForPageToLoad(1000)
    assertTitle('Home')
    type('author','jim')
    clickAndWait('reviewsubmit')
    assertTextPresent('Error adding Review!')
#{/selenium}

#{selenium 'both fields missing in addreview'}
	clearSession()
	open('/')
	waitForPageToLoad(1000)
    assertTitle('Home')
    clickAndWait('reviewsubmit')
    assertTextPresent('Error adding Review!')
#{/selenium}

#{selenium 'admin access need login'}
	clickAndWait('link=Go to Admin Area')
	assertTitle('Login')
	type('username','admin@bookshop.com')
	type('password','bookshopadmin')
	clickAndWait('signin')
	assertTitle('Administration')
	assertTextPresent('Taberna Libraria administration')
	assertTextPresent('Welcome BookshopAdmin')
	clickAndWait('link=Log out')

	
#{/selenium}